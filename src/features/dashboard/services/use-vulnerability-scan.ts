import { api } from "@/api";

interface VulnerabilityScanResponse {
  id: string;
  type: string;
  severity: "critical" | "high" | "medium" | "low" | "info";
  description?: string;
  url: string;
  evidence?: string;
  recommendation?: string;
  aiAnalysis?: string;
}

export const vulnerabilityScan = (url: string) =>
  api.post<{ url: string; response: VulnerabilityScanResponse[] }>("/test", {
    url,
  });
